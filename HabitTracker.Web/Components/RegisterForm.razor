@using HabitTracker.Shared.DataTransferObjects;
@inject IUserService userServise;
@inject IHabitListService habitListService;
@attribute [AllowAnonymous]

<div class="register-form">

    <h3>Register</h3>

    <form onsubmit="@Submit">
        <input type="text" @bind-value="UserName" placeholder="username" />
        <input type="email" @bind-value="Email" placeholder="email" />
        <input type="password" @bind-value="Password" placeholder="password" />
        <input type="password" @bind-value="PasswordRepeat" placeholder="repeat password" />
        <p class="error @appearance">Password does not match</p>
        <button type="submit">Register</button>
    </form>

</div>

@code {
    public string UserName;
    public string Password;
    public string PasswordRepeat;
    public string Email;
    public string appearance = "hide";


    private async void Submit()
    {

        if ((Password == PasswordRepeat) || (!String.IsNullOrEmpty(Password)))
        {
            appearance = "hide";
            UserForRegistrationDto userRegister = new UserForRegistrationDto()
                {
                    UserName = this.UserName,
                    Email = this.Email,
                    Password = this.Password
                };

            userServise.RegisterUser(userRegister);

            UserDto user = await userServise.GetUserFromUsername(userRegister.UserName);

            Console.WriteLine(user.Id);


        }
        else
        {
            appearance = "show";
        }

    }
}
